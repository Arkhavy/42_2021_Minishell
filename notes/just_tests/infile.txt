infile
# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    infile.txt                                         :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: ljohnson <ljohnson@student.42lyon.fr>      +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/02/12 08:35:50 by ljohnson          #+#    #+#              #
#    Updated: 2022/02/14 10:08:43 by ljohnson         ###   ########lyon.fr    #
#                                                                              #
# **************************************************************************** #

.PHONY: all clean fclean re
# .SILENT:

NAME		:=	minishell
LIBFT		:=	libft/libft.a

#//////////////////////////////////////////////////////////////////////////////
#		ALL FILES
#//////////////////////////////////////////////////////////////////////////////

SRC_LST		:=	minishell.c

HEAD_LST	:=	minishell.h

OBJ_LST		:=	$(SRC_LST:.c=.o)

HEAD_PATH	:=	mini_inc/
HEADFT_PATH	:=	libft/lib_includes/
SRC_PATH	:=	mini_src/
OBJ_PATH	:=	.mini_obj/

SRCS		:=	$(addprefix $(SRC_PATH),$(SRC_LST))
HEADERS		:=	$(addprefix $(HEAD_PATH),$(HEAD_LST))
OBJS		:=	$(addprefix $(OBJ_PATH),$(OBJ_LST))

#//////////////////////////////////////////////////////////////////////////////
#		COMMAND SHORTCUTS
#//////////////////////////////////////////////////////////////////////////////

CC			:=	gcc
CF			:=	-Wall -Wextra -Werror -lreadline
CI			:=	-I $(HEAD_PATH) -I $(HEADFT_PATH)
CS			:=	-g -fsanitize=address
CG			:=	-g3

RM			:=	rm -rf

#//////////////////////////////////////////////////////////////////////////////
#		RULES
#//////////////////////////////////////////////////////////////////////////////

all: $(NAME) $(LIBFT)

# Binary creation

$(NAME): $(OBJS) $(HEAD) $(LIBFT) Makefile
	$(CC) $(CF) $(CI) $(OBJS) $(LIBFT) -o $@
	
$(OBJ_PATH)%.o: $(SRC_PATH)%.c $(HEADERS) $(LIBFT) | $(OBJ_PATH)
	$(CC) $(CF) $(CI) -c $< -o $(<:.c=.o)

$(OBJ_PATH):
	mkdir -p .ms_obj/

$(LIBFT): libft/Makefile
	$(MAKE) -j 3 -C libft/

# Mandatory rules

clean:
	$(RM) $(OBJS)
	$(RM) $(OBJ_PATH)

fclean: clean
	$(RM) $(NAME)
	$(MAKE) fclean -C libft/
	
re: fclean all
infile